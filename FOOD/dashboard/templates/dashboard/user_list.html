{% extends 'dashboard/base_dashboard.html' %}

{% block page_title %}User Management{% endblock %}

{% block content %}
<div class="card">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h3 style="margin: 0;">Platform Users</h3>
        <div style="font-size: 0.875rem; color: var(--text-muted);">
            Total: {{ users|length }} Members
        </div>
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>User ID</th>
                    <th>User Details</th>
                    <th>Role</th>
                    <th>Date Joined</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                <tr>
                    <td><span style="font-weight: 700; color: var(--text-muted);">#{{ user.id }}</span></td>
                    <td>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <div
                                style="width: 36px; height: 36px; border-radius: 50%; background: #f1f5f9; display: flex; align-items: center; justify-content: center; font-weight: 700; color: var(--primary);">
                                {{ user.username|first|upper }}
                            </div>
                            <div>
                                <div style="font-weight: 600;">{{ user.username }}</div>
                                <div style="font-size: 0.75rem; color: var(--text-muted);">{{ user.email }}</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <span
                            class="badge {% if user.role == 'admin' %}badge-danger{% elif user.role == 'rider' %}badge-warning{% elif user.role == 'restaurant' %}badge-success{% else %}badge-primary{% endif %}">
                            <i data-lucide="{% if user.role == 'admin' %}shield-check{% elif user.role == 'rider' %}bike{% else %}user{% endif %}"
                                style="width: 14px; height: 14px;"></i>
                            {{ user.role|title }}
                        </span>
                    </td>
                    <td>
                        <div style="font-size: 0.875rem;">{{ user.date_joined|date:"M d, Y" }}</div>
                    </td>
                    <td>
                        {% if user.is_active %}
                        <span class="badge badge-success" style="background: #ecfdf5; color: #10b981;">Active</span>
                        {% else %}
                        <span class="badge badge-danger" style="background: #fef2f2; color: #ef4444;">Inactive</span>
                        {% endif %}
                    </td>
                    <td>
                        {% if not user.is_superuser %}
                        <div style="display: flex; gap: 8px;">
                            <form action="{% url 'delete_user' user.id %}" method="post" style="display: inline;"
                                onsubmit="return confirm('Silme işlemini onaylıyor musunuz? Bu işlem geri alınamaz.');">
                                {% csrf_token %}
                                <button type="submit" class="btn-logout" title="Delete User"
                                    style="width: 36px; height: 36px; padding: 0;">
                                    <i data-lucide="trash-2" style="width: 16px; height: 16px;"></i>
                                </button>
                            </form>
                        </div>
                        {% else %}
                        <span style="font-size: 0.75rem; color: var(--text-muted);">System Protected</span>
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" style="text-align: center; padding: 3rem; color: var(--text-muted);">No users found.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}